<p-confirmDialog key="primary" />
<p-confirmDialog key="secondary" />
<div class="flex h-[694px] w-screen">
  <div
    class="flex flex-col w-[75px] bg-teal-400 border-r border-white gap-8 justify-between"
    *ngIf="{
      loaded: monitoringService.isLoadTarget$ | async,
      widgets: monitoringService.widgets$ | async,
      search: monitoringService.search$ | async,
    } as analyzeData"
  >
    <ul
      class="flex items-center flex-col gap-y-4 p-2"
      *ngIf="analyzeData.loaded === true"
    >
      <li class="leading-none">
        <button
          class="outline-none"
          (click)="monitoringService.toggleSearch()"
          pInputText
          pTooltip="SEARCH"
          tooltipPosition="right"
        >
          <span
            class="pi pi-search w-7 h-7 text-2xl text-white hover:scale-110 duration-150 place-content-center"
          >
          </span>
        </button>
      </li>
      <li #openQuery class="leading-none">
        <button
          class="outline-none"
          (click)="openQueryDialog()"
          pInputText
          pTooltip="OPEN SAVED QUERIES"
          tooltipPosition="right"
        >
          <span
            class="pi pi-chart-bar w-7 h-7 text-2xl text-white hover:scale-110 duration-150 place-content-center"
          >
          </span>
        </button>
      </li>
      <li #createQuery class="border-b-lime-300 border-b pb-2">
        <button
          class="outline-none"
          (click)="showQueryDialog()"
          pInputText
          pTooltip="CREATE QUERY"
          tooltipPosition="right"
        >
          <span
            class="pi pi-plus w-7 h-7 text-2xl text-white hover:scale-110 duration-150 place-content-center"
          >
          </span>
        </button>
      </li>
      <li #widgetIdentities class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.IDENTITIES)"
          pInputText
          pTooltip="IDENTITIES"
          tooltipPosition="right"
        >
          <span
            class="pi pi-id-card w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.IDENTITIES)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>
      <li #widgetIpTraffic class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.IP_TRAFFIC)"
          pInputText
          pTooltip="IP TRAFFIC SUMMARY"
          tooltipPosition="right"
        >
          <svg
            class="w-7 h-7 hover:scale-110 duration-150 transform"
            [ngClass]="{
              'cursor-default hover:transform-none': isWidgetActive(
                analyzeData.widgets,
                widgetAnalyze.IP_TRAFFIC
              ),
              'fill-orange-500': isWidgetActive(
                analyzeData.widgets,
                widgetAnalyze.IP_TRAFFIC
              ),
              'fill-white': !isWidgetActive(
                analyzeData.widgets,
                widgetAnalyze.IP_TRAFFIC
              ),
            }"
            width="26px"
            height="26px"
            viewBox="0 0 32 32"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g>
              <path
                d="M26.7,2.3c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4c3.5,3.5,3.5,9.1,0,12.6c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3
              s0.5-0.1,0.7-0.3C31,13.5,31,6.5,26.7,2.3z"
              />
              <path
                d="M22,12.6c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c1.1-1.1,1.7-2.5,1.6-4.1c0-1.5-0.7-3-1.8-4.1
              c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4C23.3,8.7,23.4,11.2,22,12.6z"
              />
              <path
                d="M6.7,16.3c-3.5-3.5-3.5-9.1,0-12.6c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0C1,6.5,1,13.5,5.3,17.7C5.5,17.9,5.7,18,6,18
              s0.5-0.1,0.7-0.3C7.1,17.3,7.1,16.7,6.7,16.3z"
              />
              <path
                d="M8.8,14.2c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4c-1.5-1.5-1.6-4-0.2-5.4c0.4-0.4,0.4-1,0-1.4
              S9,5.6,8.6,6C7.5,7.1,7,8.5,7,10.1C7,11.6,7.7,13.1,8.8,14.2z"
              />
              <path
                d="M24,28h-2.2l-4-15.6C18.5,11.9,19,11,19,10c0-1.7-1.3-3-3-3s-3,1.3-3,3c0,1,0.5,1.9,1.3,2.4l-4,15.6H8c-0.6,0-1,0.4-1,1
              s0.4,1,1,1h16c0.6,0,1-0.4,1-1S24.6,28,24,28z M17.6,20h-3.3l1.6-6.3L17.6,20z M13.9,22c0,0,0.1,0,0.1,0h4c0.1,0,0.1,0,0.1,0l1.6,6
              h-7.4L13.9,22z"
              />
            </g>
          </svg>
        </button>
      </li>
      <li #widgetMap class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.MAP)"
          pInputText
          pTooltip="MAP"
          tooltipPosition="right"
        >
          <span
            class="pi pi-map w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.MAP)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>
      <li #widgetMetadata class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.METADATA)"
          pInputText
          pTooltip="METADATA"
          tooltipPosition="right"
        >
          <span
            class="pi pi-database w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.METADATA)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>
      <li #widgetNote class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.NOTE)"
          pInputText
          pTooltip="NOTE"
          tooltipPosition="right"
        >
          <span
            class="pi pi-file-edit w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.NOTE)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>
      <li #widgetPlayerAudio class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.PLAYER_AUDIO)"
          pInputText
          pTooltip="AUDIO PLAYER"
          tooltipPosition="right"
        >
          <span
            class="pi pi-headphones w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.PLAYER_AUDIO)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>
      <li #widgetPlayerVideo class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.PLAYER_VIDEO)"
          pInputText
          pTooltip="VIDEO PLAYER"
          tooltipPosition="right"
        >
          <svg
            class="w-7 h-7 hover:scale-110 duration-150 transform"
            [ngClass]="{
              'cursor-default hover:transform-none': isWidgetActive(
                analyzeData.widgets,
                widgetAnalyze.PLAYER_VIDEO
              ),
            }"
            width="26px"
            height="26px"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M11.9426 1.25H12.0574C14.3658 1.24999 16.1748 1.24998 17.5863 1.43975C19.031 1.63399 20.1711 2.03933 21.0659 2.93414C21.9607 3.82895 22.366 4.96897 22.5603 6.41371C22.75 7.82519 22.75 9.63423 22.75 11.9426V12.0574C22.75 14.3658 22.75 16.1748 22.5603 17.5863C22.366 19.031 21.9607 20.1711 21.0659 21.0659C20.1711 21.9607 19.031 22.366 17.5863 22.5603C16.1748 22.75 14.3658 22.75 12.0574 22.75H11.9426C9.63423 22.75 7.82519 22.75 6.41371 22.5603C4.96897 22.366 3.82895 21.9607 2.93414 21.0659C2.03933 20.1711 1.63399 19.031 1.43975 17.5863C1.24998 16.1748 1.24999 14.3658 1.25 12.0574V11.9426C1.24999 9.63423 1.24998 7.82519 1.43975 6.41371C1.63399 4.96897 2.03933 3.82895 2.93414 2.93414C3.82895 2.03933 4.96897 1.63399 6.41371 1.43975C7.82519 1.24998 9.63423 1.24999 11.9426 1.25ZM6.25 2.98181C5.18517 3.16506 4.5083 3.4813 3.9948 3.9948C3.4813 4.50829 3.16506 5.18517 2.98181 6.25H6.25V2.98181ZM7.75 2.81997V6.25H11.25V2.75028C9.8547 2.75175 8.70923 2.76108 7.75 2.81997ZM12.75 2.75028V6.25H16.25V2.81997C15.2908 2.76108 14.1453 2.75175 12.75 2.75028ZM17.75 2.98181V6.25H21.0182C20.8349 5.18517 20.5187 4.5083 20.0052 3.9948C19.4917 3.4813 18.8148 3.16506 17.75 2.98181ZM21.18 7.75H17.0006C17.0004 7.75 17.0008 7.75 17.0006 7.75C17.0004 7.75 16.9996 7.75 16.9994 7.75L12.0009 7.75C12.0006 7.75 12.0011 7.75 12.0009 7.75C12.0006 7.75 11.9994 7.75 11.9991 7.75L7.00106 7.75C7.00071 7.75 7.00035 7.75 7 7.75C6.99965 7.75 6.9993 7.75 6.99894 7.75H2.81997C2.75085 8.87584 2.75 10.2582 2.75 12C2.75 13.7418 2.75085 15.1242 2.81997 16.25L21.18 16.25C21.2491 15.1242 21.25 13.7418 21.25 12C21.25 10.2582 21.2491 8.87584 21.18 7.75ZM21.0182 17.75H17.75V21.0182C18.8148 20.8349 19.4917 20.5187 20.0052 20.0052C20.5187 19.4917 20.8349 18.8148 21.0182 17.75ZM16.25 21.18V17.75H12.75V21.2497C14.1453 21.2483 15.2908 21.2389 16.25 21.18ZM11.25 21.2497V17.75H7.75L7.75 21.18C8.70923 21.2389 9.8547 21.2483 11.25 21.2497ZM6.25 21.0182L6.25 17.75H2.98181C3.16506 18.8148 3.4813 19.4917 3.9948 20.0052C4.50829 20.5187 5.18517 20.8349 6.25 21.0182ZM12.7793 9.74813C12.796 9.75934 12.8127 9.77059 12.8295 9.78187C12.845 9.79229 12.8605 9.80266 12.8759 9.81301C13.3656 10.1421 13.8034 10.4362 14.111 10.7196C14.445 11.0273 14.75 11.4337 14.75 12C14.75 12.5663 14.445 12.9727 14.111 13.2804C13.8034 13.5638 13.3656 13.8579 12.8759 14.187L12.8295 14.2181C12.8128 14.2294 12.796 14.2407 12.7794 14.2519C12.2858 14.5836 11.8415 14.8824 11.4681 15.0551C11.0758 15.2365 10.5194 15.3914 9.98642 15.0386C9.49674 14.7146 9.36158 14.1731 9.3061 13.7395C9.24993 13.3004 9.24996 12.7235 9.25 12.0514V11.9486C9.24996 11.2765 9.24993 10.6996 9.3061 10.2605C9.36158 9.82686 9.49674 9.28543 9.98642 8.96138C10.5194 8.60864 11.0758 8.76347 11.4681 8.94491C11.8414 9.1176 12.2858 9.41635 12.7793 9.74813ZM10.8193 10.2977C10.8255 10.3004 10.8318 10.3033 10.8384 10.3063C11.0893 10.4224 11.4327 10.6504 11.9928 11.0268C12.5436 11.397 12.8823 11.6272 13.0946 11.8228C13.1937 11.9141 13.232 11.9688 13.2457 11.9934C13.2472 11.9961 13.2483 11.9983 13.2491 12C13.2483 12.0017 13.2472 12.0039 13.2457 12.0066C13.232 12.0312 13.1937 12.0859 13.0946 12.1772C12.8823 12.3728 12.5436 12.603 11.9928 12.9732C11.4327 13.3496 11.0893 13.5776 10.8384 13.6937C10.8318 13.6967 10.8255 13.6996 10.8193 13.7023C10.8109 13.663 10.8021 13.6127 10.794 13.5491C10.7515 13.2171 10.75 12.738 10.75 12C10.75 11.262 10.7515 10.7829 10.794 10.4509C10.8021 10.3873 10.8109 10.337 10.8193 10.2977Z"
              [ngClass]="
                isWidgetActive(analyzeData.widgets, widgetAnalyze.PLAYER_VIDEO)
                  ? 'fill-orange-500'
                  : 'fill-white'
              "
            />
          </svg>
        </button>
      </li>
      <li #widgetTranscription class="leading-none">
        <button
          class="outline-none"
          (click)="openWidget(widgetAnalyze.TRANSCRIPTION)"
          pInputText
          pTooltip="TRANSCRIPTION"
          tooltipPosition="right"
        >
          <span
            class="pi pi-clipboard w-7 h-7 text-2xl place-content-center"
            [ngClass]="
              isWidgetActive(analyzeData.widgets, widgetAnalyze.TRANSCRIPTION)
                ? 'text-orange-500 cursor-default hover:transform-none'
                : 'text-white hover:scale-110 duration-150'
            "
          >
          </span>
        </button>
      </li>

      <!-- <li #widgetViewerPDF class="leading-none">
          <button
            class="outline-none"
            (click)="openWidget(widgetAnalyze.VIEWER_PDF)"
            pInputText
            pTooltip="PDF VIEWER"
            tooltipPosition="right"
          >
            <span
              class="pi pi-image w-7 h-7 text-2xl place-content-center"
              [ngClass]="
                isWidgetActive(analyzeData.widgets, widgetAnalyze.VIEWER_PDF)
                  ? 'text-orange-500 cursor-default hover:transform-none'
                  : 'text-white hover:scale-110 duration-150'
              "
            >
            </span>
          </button>
        </li> -->
      <!-- <li #widgetmy class="leading-none">
          <button
            class="outline-none"
            (click)="openWidget(widgetAnalyze.MY_WIDGET)"
            pInputText
            pTooltip="WIDGET"
            tooltipPosition="right"
          >
            <span
              class="pi pi-th-large w-7 h-7 text-2xl place-content-center"
              [ngClass]="
                isWidgetActive(analyzeData.widgets, widgetAnalyze.MY_WIDGET)
                  ? 'text-orange-500 cursor-default hover:transform-none'
                  : 'text-white hover:scale-110 duration-150'
              "
            >
            </span>
          </button>
        </li> -->
    </ul>
    <div>
      <ul
        class="flex items-center flex-col gap-y-4 p-2 flex-end"
        *ngIf="analyzeData.loaded === true"
      >
        <li>
          <button
            class="outline-none"
            (click)="saveQuery()"
            pInputText
            pTooltip="SAVE QUERY & STATE"
            tooltipPosition="right"
          >
            <span
              class="pi pi-save w-7 h-7 text-2xl text-white hover:scale-110 duration-150 place-content-center"
            >
            </span>
          </button>
        </li>
        <li class="leading-none">
          <button
            class="outline-none"
            (click)="saveLayout()"
            pInputText
            pTooltip="SAVE AS DEFAULT LAYOUT"
            tooltipPosition="right"
          >
            <span
              class="pi pi-objects-column w-7 h-7 text-2xl text-white hover:scale-110 duration-150 place-content-center"
            >
            </span>
          </button>
        </li>
      </ul>
    </div>
  </div>
  <div class="flex-1 relative">
    <gridster
      [options]="options"
      class="scrollbar-thin scrollbar-thumb-neutral-500 scrollbar-track-neutral-100 scrollbar-thumb-rounded-full scrollbar-track-rounded-full"
    >
      <gridster-item
        [item]="item"
        *ngFor="let item of monitoringService.widgets$ | async"
      >
        <app-layout-widget
          [type]="item.type"
          [resizeEvent]="resizeEvent"
        ></app-layout-widget>
      </gridster-item>
    </gridster>
    <!-- <app-analyze-search></app-analyze-search> -->
  </div>
</div>
